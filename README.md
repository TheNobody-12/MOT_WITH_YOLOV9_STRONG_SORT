# Yolov9 + StrongSORT with OSNet

![003-gif](https://github.com/TheNobody-12/MOT_WITH_YOLOV9_STRONG_SORT/assets/75840118/e0fb707f-c348-4763-a5f4-ec1225eaafc8)

## Introduction

This repository contains a highly configurable two-stage-tracker that adjusts to different deployment scenarios. The detections generated by [YOLOv9](https://github.com/WongKinYiu/yolov9), a family of object detection architectures and models pretrained on the COCO dataset, are passed to [StrongSORT](https://github.com/dyhBUPT/StrongSORT)[](https://arxiv.org/pdf/2202.13514.pdf) which combines motion and appearance information based on [OSNet](https://github.com/KaiyangZhou/deep-person-reid)[](https://arxiv.org/abs/1905.00953) in order to tracks the objects. It can track any object that your Yolov9 model was trained to detect.

## Before you run the tracker

1. Clone the repository recursively:

`git clone --recurse-submodules  https://github.com/TheNobody-12/MOT_WITH_YOLOV9_STRONG_SORT.git`

If you already cloned and forgot to use `--recurse-submodules` you can run `git submodule update --init`

2. Make sure that you fulfill all the requirements: Python 3.8 or later with all [requirements.txt](https://github.com/TheNobody-12/MOT_WITH_YOLOV9_STRONG_SORT/blob/main/requirements.txt) dependencies installed, including torch>=1.7. To install, run:
   - Look for appropriate Pytorch version here [Pytorch](https://pytorch.org/)

`pip install -r requirements.txt`


## Tracking sources

Tracking can be run on most video formats

```bash
$ python track.py --source 0  # webcam
                           img.jpg  # image
                           vid.mp4  # video
                           path/  # directory
                           path/*.jpg  # glob
                           'https://youtu.be/Zgi9g1ksQHc'  # YouTube
                           'rtsp://example.com/media.mp4'  # RTSP, RTMP, HTTP stream
```


## Select object detection and ReID model

### Yolov9

There is a clear trade-off between model inference speed and accuracy. In order to make it possible to fulfill your inference speed/accuracy needs
 You can download the Yolov9 weights from the [official Yolov9 repository](https://github.com/WongKinYiu/yolov9/releases/tag/v0.1)
```bash


$ python track.py --source 0 --yolo-weights yolov9-c.pt --img 640
                                            yolov9-e.pt --img 640
                                            yolov9-c-converted.pt --img 1280
                                            ...
```

### StrongSORT

The above applies to StrongSORT models as well. Choose a ReID model based on your needs from this ReID [model zoo](https://kaiyangzhou.github.io/deep-person-reid/MODEL_ZOO)

```bash


$ python track.py --source 0 --strong-sort-weights osnet_x0_25_market1501.pt
                                                   osnet_x0_5_market1501.pt
                                                   osnet_x0_75_msmt17.pt
                                                   osnet_x1_0_msmt17.pt
                                                   ...
```


## Filter tracked classes

By default the tracker tracks all MS COCO classes.

If you want to track a subset of the MS COCO classes, add their corresponding index after the classes flag

```bash
python track.py --source 0 --yolo-weights yolov9.pt --classes 16 17  # tracks cats and dogs, only
```

[Here](https://tech.amikelive.com/node-718/what-object-categories-labels-are-in-coco-dataset/) is a list of all the possible objects that a Yolov9 model trained on MS COCO can detect. Notice that the indexing for the classes in this repo starts at zero.


## MOT compliant results

Can be saved to your experiment folder `runs/track/<yolo_model>_<deep_sort_model>/` by 

```bash
python track.py --source ... --save-txt
```


## Cite

If you find this project useful in your research, please consider cite:

```latex
@misc{yolov9-strongsort-osnet-2024,
    title={Real-time multi-camera multi-object tracker using YOLOv9 and StrongSORT with OSNet},
    author={SARTHAK KAPALIYA},
    howpublished = {\url{https://github.com/TheNobody-12/MOT_WITH_YOLOV9_STRONG_SOR}},
    year={2024}
}
```

## Contact 

For Yolov9 StrongSort OSNet bugs and feature requests please visit [GitHub Issues](https://github.com/TheNobody-12/MOT_WITH_YOLOV9_STRONG_SORT/issues). For business inquiries or professional support requests please send an email to: sarthakkapaliya409@gmail.com
